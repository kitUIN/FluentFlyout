<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:FluentFlyout"
    xmlns:controls="clr-namespace:FluentFlyout.Controls"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:micaControls="clr-namespace:MicaWPF.Controls;assembly=MicaWPF"
    xmlns:converters="clr-namespace:FluentFlyout.Converters">

    <Style TargetType="{x:Type controls:FluentMediaFlyout}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:FluentMediaFlyout}">
                    <Grid x:Name="RootGrid">
                        <Grid.Resources>
                            <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
                        </Grid.Resources>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Margin="12" Orientation="Horizontal">
                            <Border x:Name="SongImageBorder" CornerRadius="6" BorderThickness="1"
                                    BorderBrush="#26FFFFFF"
                                    Margin="0" ClipToBounds="True" Width="78" Height="78">
                                <ui:SymbolIcon x:Name="SongImagePlaceholder" Symbol="MusicNote220" FontSize="40"
                                               Filled="True"
                                               Foreground="{DynamicResource MicaWPF.Brushes.SystemAccentColorLight2}"
                                               Visibility="Collapsed" />
                                <Border.Background>
                                    <ImageBrush x:Name="SongImage"
                                                ImageSource="{Binding  RelativeSource={RelativeSource TemplatedParent}, Path=SongImageSource, Mode=TwoWay}"
                                                Stretch="UniformToFill" />
                                </Border.Background>
                            </Border>
                            <StackPanel x:Name="BodyStackPanel" Orientation="Vertical" VerticalAlignment="Center">
                                <StackPanel Name="SongInfoStackPanel" Width="182" MaxWidth="182" Margin="12,0,0,0"
                                            Orientation="Vertical"
                                            VerticalAlignment="Center">
                                    <TextBlock x:Name="SongTitle" Text="{TemplateBinding SongTitle}" FontSize="14"
                                               HorizontalAlignment="Left"
                                               FontFamily="Segoe UI Variable" FontWeight="Medium"
                                               TextTrimming="CharacterEllipsis" IsHitTestVisible="False" />
                                    <TextBlock x:Name="SongArtist" Text="{TemplateBinding SongArtist}" FontSize="14"
                                               HorizontalAlignment="Left"
                                               FontFamily="Segoe UI Variable" FontWeight="Medium" Opacity="0.5"
                                               TextTrimming="CharacterEllipsis" IsHitTestVisible="False" />
                                </StackPanel>
                                <StackPanel Name="ControlsStackPanel" Orientation="Horizontal"
                                            HorizontalAlignment="Right" Height="35" Margin="12,8,0,0">
                                    <micaControls:Button
                                        Height="{StaticResource MediaFlyoutButtonSmallHeight}"
                                        Width="{StaticResource MediaFlyoutButtonSmallWidth}" Name="ControlBack"
                                        Command="{TemplateBinding BackCommand}"
                                        Margin="2,0,8,0" Focusable="False"
                                        Style="{StaticResource MicaWPF.Styles.TransparentButton}"
                                        VerticalAlignment="Center">
                                        <ui:SymbolIcon Name="SymbolBack" Symbol="Previous20" Filled="True" />
                                    </micaControls:Button>
                                    <micaControls:Button
                                        Height="32" Width="32" Name="ControlPlayPause"
                                        Command="{TemplateBinding PlayPauseCommand}"
                                        Margin="0,0,8,0" Focusable="False"
                                        Style="{StaticResource MicaWPF.Styles.AccentedButton}"
                                        VerticalAlignment="Center">
                                        <ui:SymbolIcon Name="SymbolPlayPause" Symbol="Pause16" Filled="True" />
                                    </micaControls:Button>
                                    <micaControls:Button
                                        Height="{StaticResource MediaFlyoutButtonSmallHeight}"
                                        Width="{StaticResource MediaFlyoutButtonSmallWidth}"
                                        Command="{TemplateBinding ForwardCommand}"
                                        Name="ControlForward"
                                        Margin="0,0,8,0" Focusable="False"
                                        Style="{StaticResource MicaWPF.Styles.TransparentButton}"
                                        VerticalAlignment="Center">
                                        <ui:SymbolIcon Name="SymbolForward" Symbol="Next20" Filled="True" />
                                    </micaControls:Button>
                                    <micaControls:Button Name="ControlClose"
                                                         Height="{StaticResource MediaFlyoutButtonSmallHeight}"
                                                         Width="{StaticResource MediaFlyoutButtonSmallWidth}"
                                                         Margin="0,0,8,0"
                                                         Style="{StaticResource MicaWPF.Styles.TransparentButton}"
                                                         VerticalAlignment="Center"
                                                         Command="{TemplateBinding CloseCommand}"
                                                         Visibility="Collapsed">
                                        <ui:SymbolIcon Symbol="Dismiss20" Filled="True" />
                                    </micaControls:Button>
                                    <micaControls:Button
                                        Height="{StaticResource MediaFlyoutButtonSmallHeight}"
                                        Width="{StaticResource MediaFlyoutButtonSmallWidth}" x:Name="ControlRepeat"
                                        Margin="0,0,8,0" Focusable="False"
                                        Command="{TemplateBinding RepeatCommand}"
                                        Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=RepeatEnabled, Mode=TwoWay,Converter={StaticResource BoolToVisibilityConverter}}"
                                        Style="{StaticResource MicaWPF.Styles.TransparentButton}"
                                        VerticalAlignment="Center">
                                        <ui:SymbolIcon x:Name="SymbolRepeat" Symbol="ArrowRepeatAllOff24"
                                                       Filled="false"
                                                       Opacity="0.5" FontSize="18" />
                                    </micaControls:Button>
                                    <micaControls:Button
                                        Height="{StaticResource MediaFlyoutButtonSmallHeight}"
                                        Width="{StaticResource MediaFlyoutButtonSmallWidth}" x:Name="ControlShuffle"
                                        Margin="0,0,8,0" Focusable="False"
                                        Command="{TemplateBinding ShuffleCommand}"
                                        Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ShuffleEnabled, Mode=TwoWay,Converter={StaticResource BoolToVisibilityConverter}}"
                                        Style="{StaticResource MicaWPF.Styles.TransparentButton}"
                                        VerticalAlignment="Center">
                                        <ui:SymbolIcon x:Name="SymbolShuffle" Symbol="ArrowShuffleOff24" Filled="false"
                                                       Opacity="0.5" FontSize="18" />
                                    </micaControls:Button>
                                    <StackPanel x:Name="MediaIdStackPanel" Orientation="Horizontal" Width="72">
                                        <ui:SymbolIcon Symbol="MusicNote120" Width="12" Height="12" FontSize="12"
                                                       Filled="True" Opacity="0.25" />
                                        <TextBlock Name="MediaId" VerticalAlignment="Center" FontSize="10"
                                                   Margin="2,0,0,0" FontFamily="Segoe UI Variable" FontWeight="Medium"
                                                   Opacity="0.35" TextTrimming="CharacterEllipsis" />
                                    </StackPanel>

                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                        <DockPanel Grid.Row="1" x:Name="SeekbarWrapper" HorizontalAlignment="Stretch"
                                   Visibility="Collapsed"
                                   Margin="16,0,16,12" LastChildFill="True" VerticalAlignment="Center">
                            <TextBlock Name="SeekbarCurrentDuration"
                                       Text="{TemplateBinding SeekbarCurrentDuration}"
                                       Opacity="0.5" FontSize="12"
                                       DockPanel.Dock="Left" Width="45" Margin="0,0,2,0" TextAlignment="Left"
                                       VerticalAlignment="Center" Height="18" />
                            <TextBlock Name="SeekbarMaxDuration" Text="{TemplateBinding SeekbarMaxDuration}"
                                       Opacity="0.5" FontSize="12"
                                       DockPanel.Dock="Right" Width="45" Margin="2,0,0,0" TextAlignment="Right"
                                       VerticalAlignment="Center" Height="18" />
                            <Slider x:Name="PART_Seekbar"
                                    Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SeekbarValue, Mode=TwoWay}"
                                    Maximum="{TemplateBinding SeekbarMaxValue}" Minimum="0"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Center" VerticalContentAlignment="Center" Height="18">
                            </Slider>
                        </DockPanel>
                        <micaControls:Button x:Name="TopClose"
                                             Grid.Row="0"
                                             Width="28" Height="28"
                                             Style="{StaticResource MicaWPF.Styles.TransparentButton}"
                                             HorizontalAlignment="Right" VerticalAlignment="Top"
                                             Margin="0,8,8,0"
                                             Visibility="Collapsed">
                            <ui:SymbolIcon Symbol="Dismiss20" Filled="True" />
                        </micaControls:Button>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="CompactLayout" Value="True">
                            <Setter TargetName="BodyStackPanel" Property="Orientation" Value="Horizontal" />
                            <Setter TargetName="MediaIdStackPanel" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="ControlShuffle" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="ControlRepeat" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="SongImageBorder" Property="Height" Value="36" />
                            <Setter TargetName="SongImageBorder" Property="Margin" Value="0" />
                            <Setter TargetName="SongInfoStackPanel" Property="Width" Value="170" />
                            <Setter TargetName="SongInfoStackPanel" Property="MaxWidth" Value="170" />
                            <Setter TargetName="SongInfoStackPanel" Property="Margin" Value="8,0,0,0" />
                            <Setter TargetName="ControlsStackPanel" Property="Margin" Value="0" />
                        </Trigger>
                        <Trigger Property="SeekbarEnabled" Value="True">
                            <Setter TargetName="SeekbarWrapper" Property="Visibility" Value="Visible" />
                        </Trigger>
                        <Trigger Property="ShowTopClose" Value="True">
                            <Setter TargetName="TopClose" Property="Visibility" Value="Visible" />
                        </Trigger>
                        <Trigger Property="IsShuffleActive" Value="True">
                            <Setter TargetName="SymbolShuffle" Property="Symbol" Value="ArrowShuffle24" />
                        </Trigger>
                        <Trigger Property="SongImageSource" Value="{x:Null}">
                            <Setter TargetName="SongImagePlaceholder" Property="Visibility" Value="Visible" />
                        </Trigger>

                        <Trigger Property="ShowControlClose" Value="True">
                            <Setter TargetName="SongInfoStackPanel" Property="Width" Value="134" />
                            <Setter TargetName="SongInfoStackPanel" Property="MaxWidth" Value="134" />
                            <Setter TargetName="ControlClose" Property="Visibility" Value="Visible" />
                        </Trigger>
                        <Trigger Property="CenterTitleArtist" Value="True">
                            <Setter TargetName="SongTitle" Property="HorizontalAlignment" Value="Center" />
                            <Setter TargetName="SongArtist" Property="HorizontalAlignment" Value="Center" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>